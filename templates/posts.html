{% extends 'base.html' %} {% block title %}Feed - HiveBuzz{% endblock %} {%
block content %}
<div class="feed-container">
	<h2>Latest Posts</h2>

	{% if posts %}
	<div class="feed-list">
		{% for post in posts %}
		<div class="feed-item">
			<a
				href="{{ url_for('view_post', author=post.author, permlink=post.permlink) }}"
				class="post-title-link"
			>
				<h3 class="post-title">{{ post.title }}</h3>
			</a>
			<div class="post-meta">
				<a
					href="{{ url_for('profile', username=post.author) }}"
					class="post-author"
					>@{{ post.author }}</a
				>
				<span class="post-date">{{ post.created }}</span>
			</div>
			<div class="post-content">
				{% if post.body|length > 200 %} {{ post.body[:200]|safe }}...
				<a
					href="{{ url_for('view_post', author=post.author, permlink=post.permlink) }}"
					class="read-more"
					>Read more</a
				>
				{% else %} {{ post.body|safe }} {% endif %}
			</div>
			<div class="post-actions">
				<button
					class="upvote-btn"
					data-author="{{ post.author }}"
					data-permlink="{{ post.permlink }}"
				>
					üëç Upvote
				</button>
				<a
					href="{{ url_for('view_post', author=post.author, permlink=post.permlink) }}"
					class="comment-btn"
					>üí¨ Comment</a
				>
			</div>
			{% if post.tags %}
			<div class="post-tags">
				{% for tag in post.tags %}
				<span class="tag">{{ tag }}</span>
				{% endfor %}
			</div>
			{% endif %}
		</div>
		{% endfor %}
	</div>
	{% else %}
	<p class="no-results">
		No posts found.
		<a href="{{ url_for('create_post') }}">Create the first post!</a>
	</p>
	{% endif %}
</div>
{% endblock %} {% block scripts %}
<script>
	// Add upvote functionality to all upvote buttons
	document.addEventListener("DOMContentLoaded", function () {
		const upvoteBtns = document.querySelectorAll(".upvote-btn");
		upvoteBtns.forEach((btn) => {
			btn.addEventListener("click", function () {
				const author = this.getAttribute("data-author");
				const permlink = this.getAttribute("data-permlink");

				if (window.hive_keychain) {
					alert(
						`In a real implementation, this would upvote @${author}/${permlink} on the Hive blockchain.`
					);
				} else {
					alert("Hive Keychain extension is required for upvoting.");
				}
			});
		});
	});
</script>
{% endblock %}
